"use strict";angular.module("app",["app.page","app.node","app.view","ui.router","metaInfo","scrollTo","ui.bootstrap","ngSanitize","ngAnimate","ngTouch","ngResource","afkl.lazyImage","infinite-scroll"]).run(["$rootScope","$state","$stateParams","metaInfo","$window","$location",function($rootScope,$state,$stateParams,metaInfo,$window,$location){$rootScope.$state=$state,$rootScope.$stateParams=$stateParams,$rootScope.pageUrl="http://localhost:9000",$rootScope.apiUrl="http://api.ad.albatrossdemos.com/";var share42=document.createElement("script");$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState){if(toState.data){var title=toState.data.title&&toState.data.title.length?toState.data.title:"";metaInfo.setTitle(title);var description=toState.data.description&&toState.data.description.length?toState.data.description:"";metaInfo.setMetaDescription(description);var keywords=toState.data.keywords&&toState.data.keywords.length?toState.data.keywords:[];metaInfo.setMetaKeywords(keywords,toState.data.keywordAppend)}else fromState.data&&metaInfo.resetAll();share42.src||(share42.src="/vendor/share42.js",share42.type="text/javascript",share42.async="true",document.body.appendChild(share42))}),$rootScope.$on("$stateChangeSuccess",function(event,toState,toParams,fromState){$window.ga&&$window.ga("send","pageview",{page:$location.path(),title:toState.data&&toState.data.title?toState.data.title:"FILLME!"}),!fromState.name||!fromState.name.length||toState.data&&toState.data&&toState.data.skipScroll||$rootScope.scrollTo("main")})}]).config(["$locationProvider","$stateProvider","$urlRouterProvider","metaInfoProvider",function($locationProvider,$stateProvider,$urlRouterProvider,metaInfoProvider){metaInfoProvider.setBaseTitle("FILLME!"),metaInfoProvider.setBaseDescription("FILLME!"),metaInfoProvider.setBaseKeywords("FILLME!"),$locationProvider.html5Mode(!0),$urlRouterProvider.rule(function($injector,$location){var path=$location.url(),argPos=path.indexOf("/?");return path.length>1?"/"===path[path.length-1]?path.substring(0,path.length-1):argPos>0?path.replace("/?","?"):"/":void 0}),$stateProvider.state("home",{url:"/",templateUrl:"views/home.html"})}]),angular.module("scrollTo",[]).run(["$rootScope",function($rootScope){$rootScope.scrollTo=function(eID){function currentYPosition(){return window.pageYOffset?window.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}function elmYPosition(eID){if(eID){for(var elm=document.getElementById(eID),y=elm.offsetTop,node=elm;node.offsetParent&&node.offsetParent!=document.body;)node=node.offsetParent,y+=node.offsetTop;return y}}var i,startY=currentYPosition(),stopY=elmYPosition(eID),distance=stopY>startY?stopY-startY:startY-stopY;if(100>distance)return void scrollTo(0,stopY);var speed=Math.round(distance/100);speed>=20&&(speed=20);var step=Math.round(distance/25),leapY=stopY>startY?startY+step:startY-step,timer=0;if(stopY>startY)for(i=startY;stopY>i;i+=step)setTimeout("window.scrollTo(0, "+leapY+")",timer*speed),leapY+=step,leapY>stopY&&(leapY=stopY),timer++;else for(i=startY;i>stopY;i-=step)setTimeout("window.scrollTo(0, "+leapY+")",timer*speed),leapY-=step,stopY>leapY&&(leapY=stopY),timer++}}]),angular.module("app.page",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function($stateProvider){$stateProvider.state("about",{url:"/about",data:{title:"About",description:"About the about",keywords:"About, this, page",skipScroll:!1},templateUrl:"views/about.html"})}]),angular.module("app.node",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function($stateProvider){$stateProvider.state("node",{url:"/node/:nid",template:'<div class="node node-{{type}}" ui-view></div>',data:{title:"Node",description:"About the about",keywords:"About, this, page",skipScroll:!1},resolve:{node:function($stateParams,Node){return Node.get({nodeId:$stateParams.nid}).$promise.then(function(data){return $stateParams.type=data.type[0].target_id,data})}},controller:function($scope,$state,node){$scope.node=node,$scope.type=node.type[0].target_id,$state.$current.data.title=node.title[0].value,$scope.$watch("node",function(){var stateName="node."+$scope.type;try{var state=$state.get(stateName);if(void 0==state||null==state)throw"myException"}catch(e){stateName="node.base"}$state.go(stateName)})}}).state("node.base",{templateUrl:"views/node.html"})}]),angular.module("app.view",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function($stateProvider){$stateProvider.state("view",{url:"/view/:name",template:'<div class="view view-{{name}}" ui-view></div>',data:{title:"View",description:"About the about",keywords:"About, this, page",skipScroll:!1},resolve:{items:function($stateParams,View){return View.query({name:$stateParams.name}).$promise.then(function(data){return data})}},controller:function($scope,$state,items,View){$scope.items=items,$scope.name=$state.params.name,$scope.$watch("items",function(){var stateName="view."+$scope.name;try{var state=$state.get(stateName);if(void 0==state||null==state)throw"myException"}catch(e){stateName="view.base"}$state.go(stateName)}),$scope.currentPage=0,$scope.loadingPage=!1,$scope.addItems=function(){if(!$scope.loadingPage&&void 0!=$scope.items&&$scope.items.length>0){$scope.currentPage++;var newData=View.query({name:$scope.name,page:$scope.currentPage},function(){newData.length>0&&(Array.prototype.push.apply($scope.items,newData),$scope.loadingPage=!1)})}$scope.loadingPage=!0}}}).state("view.base",{templateUrl:"views/view.html"})}]),angular.module("metaInfo",[]).provider("metaInfo",function(){var baseTitle="",title="",baseMetaDescription="",metaDescription="",baseMetaKeywords="",metaKeywords="";this.setBaseTitle=function(newTitle){baseTitle=newTitle},this.setBaseDescription=function(description){baseMetaDescription=description},this.setBaseKeywords=function(keywords){baseMetaKeywords=keywords},this.$get=function(){return{title:function(){return title.length?title+" | "+baseTitle:baseTitle},setTitle:function(newTitle){title=newTitle},metaDescription:function(){return metaDescription.length?metaDescription:baseMetaDescription},metaKeywords:function(){return metaKeywords.length?metaKeywords:baseMetaKeywords},setMetaDescription:function(newMetaDescription){metaDescription=newMetaDescription},setMetaKeywords:function(newKeywords,append){var keywords="";for(var key in newKeywords)keywords+=", "+newKeywords[key].name;metaKeywords="undefined"!=typeof append&&append?baseMetaKeywords+keywords:keywords},resetAll:function(){title="",metaDescription="",metaKeywords=""}}}}),angular.module("app.node").factory("Node",["$resource","$rootScope",function($resource,$rootScope){return $resource($rootScope.apiUrl+"/node/:nodeId",{nodeId:"@nodeId"},{get:{method:"GET",transformRequest:function(data,headersGetter){headersGetter().Accept="application/hal+json"}}})}]),angular.module("app.view").factory("View",["$resource","$rootScope",function($resource,$rootScope){return $resource($rootScope.apiUrl+"/view/:name",{name:"@name"},{query:{method:"GET",isArray:!0,transformRequest:function(data,headersGetter){headersGetter().Accept="application/hal+json"}}})}]),angular.module("metaInfo").controller("metaInfoCtrl",["$scope","metaInfo",function($scope,metaInfo){$scope.pageTitle=function(){return metaInfo.title()},$scope.metaDescription=function(){return metaInfo.metaDescription()},$scope.metaKeywords=function(){return metaInfo.metaKeywords()}}]),angular.module("app").filter("orderByWeight",function(){return function(items,field,reverse){var filtered=[];return angular.forEach(items,function(item){filtered.push(item)}),filtered.sort(function(a,b){return a[field]>b[field]?1:-1}),reverse&&filtered.reverse(),filtered}}),angular.module("app").directive("pageReady",function($window,$browser){return{restrict:"A",link:function($scope){$browser.notifyWhenNoOutstandingRequests(function(){document.body.setAttribute("data-status","ready"),$scope.$root.$emit("pageReady"),$scope.$root.$broadcast("pageReady")})}}});